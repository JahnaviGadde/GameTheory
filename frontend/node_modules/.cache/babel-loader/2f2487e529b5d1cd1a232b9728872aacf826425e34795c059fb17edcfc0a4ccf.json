{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"./Slotstable.css\";import{useParams,useNavigate}from\"react-router-dom\";import axios from\"axios\";// Main component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function CourtSchedule(){const navigate=useNavigate();const today=new Date();const formattedToday=today.toISOString().split(\"T\")[0];const[selectedDate,setSelectedDate]=useState(formattedToday);const[courts,setCourts]=useState([]);// List of all courts\nconst[bookings,setBookings]=useState({});// Map of courtId & time slot bookings\nconst{centreId}=useParams();// Fetching centreId dynamically from route\n// Handle date change\nconst handleDateChange=e=>{setSelectedDate(e.target.value);};const times=[\"5:00 AM - 6:00 AM\",\"6:00 AM - 7:00 AM\",\"7:00 AM - 8:00 AM\",\"8:00 AM - 9:00 AM\",\"9:00 AM - 10:00 AM\",\"10:00 AM - 11:00 AM\",\"11:00 AM - 12:00 PM\",\"12:00 PM - 1:00 PM\",\"1:00 PM - 2:00 PM\",\"2:00 PM - 3:00 PM\",\"3:00 PM - 4:00 PM\",\"4:00 PM - 5:00 PM\",\"5:00 PM - 6:00 PM\",\"6:00 PM - 7:00 PM\",\"7:00 PM - 8:00 PM\",\"8:00 PM - 9:00 PM\",\"9:00 PM - 10:00 PM\",\"10:00 PM - 11:00 PM\",\"11:00 PM - 12:00 AM\"];// Fetch courts dynamically from the server\nuseEffect(()=>{const fetchCourts=async()=>{try{const response=await axios.get(\"\".concat(process.env.REACT_APP_BACKENDAPI,\"/api/court/center/\").concat(centreId));setCourts(response.data);}catch(error){console.error(\"Error fetching courts:\",error);}};fetchCourts();},[centreId]);// Fetch booking slots for courts & selected date dynamically\nuseEffect(()=>{const fetchBookings=async()=>{const bookingData={};// Prepare a map of bookings\ntry{for(let court of courts){const response=await axios.get(\"\".concat(process.env.REACT_APP_BACKENDAPI,\"/api/booking/court/\").concat(court._id,\"/date/\").concat(selectedDate));const bookingsForCourt=response.data;bookingData[court._id]={};bookingsForCourt.forEach(booking=>{const timeSlot=booking.bookingSlot;bookingData[court._id][timeSlot]=booking;});}setBookings(bookingData);}catch(error){console.error(\"Error fetching booking data\",error);}};if(courts.length)fetchBookings();},[courts,selectedDate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"court-schedule\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"date-selector\",children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:selectedDate,onChange:handleDateChange,className:\"calendar-input\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"schedule-table\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{style:{textAlign:\"center\"},children:\"Court Name\"}),times.map((time,index)=>/*#__PURE__*/_jsx(\"th\",{style:{textAlign:\"center\"},children:time},index))]})}),/*#__PURE__*/_jsx(\"tbody\",{children:courts.map(court=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"court-name\",style:{textAlign:\"center\"},children:court.name}),times.map(timeSlot=>{var _bookings$court$_id,_bookings$court$_id$t,_bookings$court$_id2,_bookings$court$_id2$;const bookingStatus=(_bookings$court$_id=bookings[court._id])===null||_bookings$court$_id===void 0?void 0:(_bookings$court$_id$t=_bookings$court$_id[timeSlot])===null||_bookings$court$_id$t===void 0?void 0:_bookings$court$_id$t.bookingStatus;const bookingId=(_bookings$court$_id2=bookings[court._id])===null||_bookings$court$_id2===void 0?void 0:(_bookings$court$_id2$=_bookings$court$_id2[timeSlot])===null||_bookings$court$_id2$===void 0?void 0:_bookings$court$_id2$._id;return/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"center\",backgroundColor:bookingStatus===\"booked\"?\"#FF7f7f\"// Red for booked\n:bookingStatus===\"empty\"?\"#ADD8E6\"// Light blue for available\n:\"#D3D3D3\",// Gray for no slot\npadding:\"8px\"},children:[bookingStatus===\"booked\"&&\"Booked\",bookingStatus===\"empty\"&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/bookslots/\".concat(bookingId),{state:{courtId:court._id,timeSlot,selectedDate}}),style:{padding:\"5px 10px\",backgroundColor:\"#007BFF\",color:\"white\",border:\"none\",borderRadius:\"5px\",cursor:\"pointer\"},children:\"Book Now\"}),bookingStatus!==\"booked\"&&bookingStatus!==\"empty\"&&\"\"]},timeSlot);})]},court._id))})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","CourtSchedule","navigate","today","Date","formattedToday","toISOString","split","selectedDate","setSelectedDate","courts","setCourts","bookings","setBookings","centreId","handleDateChange","e","target","value","times","fetchCourts","response","get","concat","process","env","REACT_APP_BACKENDAPI","data","error","console","fetchBookings","bookingData","court","_id","bookingsForCourt","forEach","booking","timeSlot","bookingSlot","length","className","children","type","onChange","style","textAlign","map","time","index","name","_bookings$court$_id","_bookings$court$_id$t","_bookings$court$_id2","_bookings$court$_id2$","bookingStatus","bookingId","backgroundColor","padding","onClick","state","courtId","color","border","borderRadius","cursor"],"sources":["C:/Users/Dell/Desktop/task/GameTheory/frontend/src/components/CourtSchedule.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./Slotstable.css\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\n\r\n// Main component\r\nexport default function CourtSchedule() {\r\n  const navigate = useNavigate();\r\n  const today = new Date();\r\n  const formattedToday = today.toISOString().split(\"T\")[0];\r\n  const [selectedDate, setSelectedDate] = useState(formattedToday);\r\n  const [courts, setCourts] = useState([]); // List of all courts\r\n  const [bookings, setBookings] = useState({}); // Map of courtId & time slot bookings\r\n\r\n  const { centreId } = useParams(); // Fetching centreId dynamically from route\r\n\r\n  // Handle date change\r\n  const handleDateChange = (e) => {\r\n    setSelectedDate(e.target.value);\r\n  };\r\n\r\n  const times = [\"5:00 AM - 6:00 AM\", \"6:00 AM - 7:00 AM\", \"7:00 AM - 8:00 AM\", \"8:00 AM - 9:00 AM\", \"9:00 AM - 10:00 AM\",\"10:00 AM - 11:00 AM\",\"11:00 AM - 12:00 PM\",\"12:00 PM - 1:00 PM\",\"1:00 PM - 2:00 PM\",\"2:00 PM - 3:00 PM\",\"3:00 PM - 4:00 PM\",\"4:00 PM - 5:00 PM\",\"5:00 PM - 6:00 PM\",\"6:00 PM - 7:00 PM\",\"7:00 PM - 8:00 PM\",\"8:00 PM - 9:00 PM\",\"9:00 PM - 10:00 PM\",\"10:00 PM - 11:00 PM\",\"11:00 PM - 12:00 AM\",];\r\n\r\n  // Fetch courts dynamically from the server\r\n  useEffect(() => {\r\n    const fetchCourts = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          `${process.env.REACT_APP_BACKENDAPI}/api/court/center/${centreId}`\r\n        );\r\n        setCourts(response.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching courts:\", error);\r\n      }\r\n    };\r\n\r\n    fetchCourts();\r\n  }, [centreId]);\r\n\r\n  // Fetch booking slots for courts & selected date dynamically\r\n  useEffect(() => {\r\n    const fetchBookings = async () => {\r\n      const bookingData = {}; // Prepare a map of bookings\r\n\r\n      try {\r\n        for (let court of courts) {\r\n          const response = await axios.get(\r\n            `${process.env.REACT_APP_BACKENDAPI}/api/booking/court/${court._id}/date/${selectedDate}`\r\n          );\r\n\r\n          const bookingsForCourt = response.data;\r\n          bookingData[court._id] = {};\r\n\r\n          bookingsForCourt.forEach((booking) => {\r\n            const timeSlot = booking.bookingSlot;\r\n            bookingData[court._id][timeSlot] = booking;\r\n          });\r\n        }\r\n\r\n        setBookings(bookingData);\r\n      } catch (error) {\r\n        console.error(\"Error fetching booking data\", error);\r\n      }\r\n    };\r\n\r\n    if (courts.length) fetchBookings();\r\n  }, [courts, selectedDate]);\r\n\r\n  return (\r\n    <div className=\"court-schedule\">\r\n      {/* Date Selector */}\r\n      <div className=\"date-selector\">\r\n        <input\r\n          type=\"date\"\r\n          value={selectedDate}\r\n          onChange={handleDateChange}\r\n          className=\"calendar-input\"\r\n        />\r\n      </div>\r\n\r\n      {/* Render the table dynamically */}\r\n      <div className=\"schedule-table\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th style={{ textAlign: \"center\" }}>Court Name</th>\r\n              {times.map((time, index) => (\r\n                <th key={index} style={{ textAlign: \"center\" }}>\r\n                  {time}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {courts.map((court) => (\r\n              <tr key={court._id}>\r\n\r\n                <td className=\"court-name\" style={{ textAlign: \"center\" }}>\r\n                  {court.name}\r\n                </td>\r\n                {times.map((timeSlot) => {\r\n                  const bookingStatus = bookings[court._id]?.[timeSlot]?.bookingStatus;\r\n                  const bookingId = bookings[court._id]?.[timeSlot]?._id; \r\n                  return (\r\n                    <td\r\n                  key={timeSlot}\r\n                  style={{\r\n                    textAlign: \"center\",\r\n                    backgroundColor:\r\n                      bookingStatus === \"booked\"\r\n                        ? \"#FF7f7f\" // Red for booked\r\n                        : bookingStatus === \"empty\"\r\n                        ? \"#ADD8E6\" // Light blue for available\r\n                        : \"#D3D3D3\", // Gray for no slot\r\n                    padding: \"8px\",\r\n                  }}\r\n                >\r\n                  {bookingStatus === \"booked\" && \"Booked\"}\r\n                  {bookingStatus === \"empty\" && (\r\n                    <button\r\n                      onClick={() =>\r\n                        navigate(`/bookslots/${bookingId}`, {\r\n                          state: { courtId: court._id, timeSlot, selectedDate },\r\n                        })\r\n                      }\r\n                      style={{\r\n                        padding: \"5px 10px\",\r\n                        backgroundColor: \"#007BFF\",\r\n                        color: \"white\",\r\n                        border: \"none\",\r\n                        borderRadius: \"5px\",\r\n                        cursor: \"pointer\",\r\n                      }}\r\n                    >\r\n                      Book Now\r\n                    </button>\r\n                  )}\r\n                  {bookingStatus !== \"booked\" && bookingStatus !== \"empty\" && \"\"}\r\n                </td>\r\n                  );\r\n                })}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}